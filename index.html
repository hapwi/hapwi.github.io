<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="195540.png" type="image/x-icon" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css"
    crossorigin="anonymous">

  <!-- Add Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <title>Golf Pool</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="maint.js"></script>

  <style>
    body {}

    .navbar {
      position: sticky;
      top: 0;
      z-index: 9999;
    }

    .card {
      z-index: 1;
    }

    .card-body {
      padding: 10;
    }

    #content {
      position: relative;
      padding-bottom: 90px;
      /* Set the padding to match the height of the bottom nav */
      min-height: calc(100vh - 120px);
      font-family: Arial, sans-serif;
      font-weight: bold;
    }


    #main-table.table-striped>tbody>tr:nth-child(odd)>td,
    #main-table.table-striped>tbody>tr:nth-child(odd)>th {
      background-color: #003e7e;
    }

    /* 
#006B54
#ca9800

hover button color
#a87e00
*/

    #main-table.table td:first-child {
      border-top-left-radius: 50px !important;
      border-bottom-left-radius: 50px !important;
    }

    #main-table.table td:last-child {
      border-top-right-radius: 50px !important;
      border-bottom-right-radius: 50px !important;
    }



    #main-table.table,
    #main-table.table tr,
    #main-table.table td {
      border: none !important;
    }

    #main-table tr {
      line-height: 3.5;
    }

    .table-responsive {
      padding: 0 15px;

    }

    .centered-container {
      display: flex;
      justify-content: center;
      padding: 0 15px;
    }

    #picksModal .modal-footer .btn-secondary {
      background-color: #ee3a43;
      /* Replace with your desired color */
      border-color: #ee3a43;
      /* Replace with your desired color */
    }


    .modal-content {
      margin: 0 auto;
      max-width: 90%;
      /* Adjust this value to control the maximum width of the modal */
    }

    /* center player picks header */
    .modal-title {
      width: 100%;
      text-align: center;
    }

    /* center the picks button */
    .modal-footer {
      display: flex;
      justify-content: center;
      align-items: center;
    }


    .modal.show {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding-top: 80px;
      /* Adjust this value according to the height of your header + desired padding */
    }




    @media (max-width: 576px) {}



    button.custom-button {
      padding: .375rem .75rem !important;
      font-size: .9rem !important;
      line-height: 1.6 !important;
      background-color: #ee3a43 !important;
      border-color: #ee3a43 !important;
      color: white !important;
      text-decoration: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
      white-space: nowrap !important;
      overflow: hidden !important;
      border-radius: 20px !important;
      box-shadow: none !important;
      border-style: solid !important;
    }

    button.custom-button:hover {
      background-color: #923434 !important;
    }
  </style>
</head>

<body id="leaderboard">
  <script>
    // Include your header.html file
    $("body").prepend('<div id="header-placeholder"></div>');
    $("#header-placeholder").load("header.html", function () {
      setPageTitle();
    });

    // Include your bottom-nav.html file
    $("body").prepend('<div id="bottom-nav-placeholder"></div>');
    $("#bottom-nav-placeholder").load("bottom-nav.html");

    function setPageTitle() {
      var pageTitle;
      var bodyId = $('body').attr('id');

      switch (bodyId) {
        case "leaderboard":
          pageTitle = "Leaderboard";
          break;
        case "about-page":
          pageTitle = "About";
          break;
        default:
          pageTitle = "Unknown";
      }

      var logo = document.querySelector(".logo");
      logo.textContent = pageTitle;
    }
  </script>

  <main id="content" class="d-flex justify-content-center">
    <div class="container">
      <div class="row">
        <div class="col-lg-10 col-md-10 col-sm-12 mx-auto">
          <div class="centered-container">
            <div class="table-responsive">
              <table id="main-table" class="table table-striped table-bordered"></table>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>


  <div id="bottom-nav-placeholder"></div>




  <div id="player-picks" style="display:none;">
    <h2>Player Picks</h2>
    <div id="picks-content"></div>
    <!-- Add Bootstrap classes to your button -->
    <button id="close-picks" class="btn btn-primary">Close</button>
  </div>

  <!-- Add Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const apiKey = 'AIzaSyCTIOtXB0RDa5Y5gubbRn328WIrqHwemrc';
    const spreadsheetId = '1iTNStqnadp4ZyR7MRkSmvX5WeialS4WST6Yy-Qv8Reo'; //leaderboard api
    const spreadsheetId2 = '1_bP0NUG6XqrF0XQvKXNm3b07QuHABfvWotsemGToyYg'; //entires api
    const spreadsheetId3 = '1zCKMy2jgG9QoIhxFqRviDm4oxEFK_ixv_tN66GmCXTc'; //players api

    async function fetchGoogleSheetsData() {
      try {
        const response = await fetch(
          `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/Copy%20of%20Leaderboard!A1:Z?key=${apiKey}`
        );
        const data = await response.json();

        if (data.error) {
          throw new Error(data.error.message);
        }

        displayTable(data);
      } catch (error) {
        console.error('Error fetching Google Sheets data:', error);
      }
    }

    function displayTable(data) {
      const {
        values
      } = data;

      if (!values || values.length === 0) {
        console.log('No data found in the Google Sheet.');
        return;
      }



      const table = document.querySelector('#main-table'); // Select the main table directly
      table.innerHTML = ''; // Clear the existing contents of the table
      table.classList.add('table', 'table-striped', 'table-bordered');

      const thead = document.createElement('thead');
      const headerRow = document.createElement('tr');

      values[0].forEach((header) => {
        const th = document.createElement('th');
        th.textContent = header;
        headerRow.appendChild(th);
      });

      thead.appendChild(headerRow);
      table.appendChild(thead);

      const tbody = document.createElement('tbody');

      values.slice(1).forEach((row, rowIndex) => { // Added rowIndex
        const tableRow = document.createElement('tr');
        tableRow.classList.add('align-items-center', 'rounded-row');
        let playerName = null; // Initialize a variable to store the player's name

        row.forEach((cell, index) => {
          const td = document.createElement('td');

          if (index === 0) {
            playerName = cell; // Store the player's name
            const div = document.createElement('div');
            div.textContent = cell;
            div.style.overflow = 'hidden';
            div.style.textOverflow = 'ellipsis';
            div.style.whiteSpace = 'nowrap';
            div.style.display = 'block'; // Ensure the div takes the width restriction into account
            div.style.maxWidth = '100%'; // Set a maximum width for the div
            div.style.paddingLeft = '15px'; // Add padding to the left of the div
            if (rowIndex % 2 === 0) {
              // For even rows (including the first one), set the text color to black
              div.style.color = 'white';
            } else {
              // For odd rows, set the text color to white
              div.style.color = 'black';
            }
            td.style.verticalAlign = 'middle'; // Apply vertical alignment to the cell
            td.appendChild(div); // Add the div to the cell
          } else if (index === 1) { // second column
            const scoreDiv = document.createElement('div');
            scoreDiv.textContent = cell;
            scoreDiv.style.width = '50px'; // Set a fixed width for the div containing the score
            scoreDiv.style.textAlign = 'right'; // Align the text to the right
            scoreDiv.style.paddingRight = '15px'; // Add padding to the right of the div
            if (rowIndex % 2 === 0) {
              // For even rows (including the first one), set the text color to black
              scoreDiv.style.color = 'white';
            } else {
              // For odd rows, set the text color to white
              scoreDiv.style.color = 'black';
            }

            const buttonDiv = document.createElement('div');
            const button = document.createElement('button');
            button.textContent = 'Picks';
            button.classList.add('custom-button'); // Add margin to the right of the button
            button.addEventListener('click', (event) => {
              console.log(
                'Picks button clicked!'); // This will log to the console when the button is clicked.
              showPlayerPicks(event, playerName); // Pass the player's name as an argument
            });
            buttonDiv.appendChild(button);

            td.classList.add('d-flex', 'justify-content-end',
              'align-items-center'); // Add Bootstrap classes for alignment and spacing
            td.appendChild(buttonDiv);
            td.appendChild(scoreDiv);
          } else {
            td.textContent = cell;
          }

          tableRow.appendChild(td);
        });

        tbody.appendChild(tableRow);
      });

      table.appendChild(tbody);
      // Replace the table inside the responsive div
      document.querySelector('.table-responsive').replaceWith(table);
    }







    async function showPlayerPicks(event, playerName) {
      event.preventDefault();

      try {
        const response1 = await fetch(
          `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId2}/values/Sheet1!A1:K?key=${apiKey}`);
        const data1 = await response1.json();
        const response2 = await fetch(
          `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId2}/values/PicksScores!A2:B1000?key=${apiKey}`
        );
        const data2 = await response2.json();

        if (data1.error) {
          throw new Error(data1.error.message);
        }

        if (data2.error) {
          throw new Error(data2.error.message);
        }

        const golferScores = {};
        data2.values.forEach(([golferName, golferScore]) => {
          golferScores[golferName] = golferScore;
        });

        displayPlayerPicks(data1, golferScores, playerName);
      } catch (error) {
        console.error('Error fetching Google Sheets data:', error);
      }
    }



    function displayPlayerPicks(data1, golferScores, playerName) {
      const {
        values: values1
      } = data1;

      if (!values1 || values1.length === 0) {
        console.log('No data found in the Google Sheet.');
        return;
      }

      const playerRow = values1.find((row) => row[0] === playerName);

      if (!playerRow) {
        console.log('No picks found for player:', playerName);
        return;
      }

      const golferNames = playerRow.slice(1, 7);

      const picksTable = document.getElementById('picks-table');
      picksTable.innerHTML = '';
      //test
      const thead = document.createElement('thead');
      const headerRow = document.createElement('tr');
      const th1 = document.createElement('th');
      th1.textContent = 'Golfer';
      // th1.style.textAlign = 'center';
      const th2 = document.createElement('th');
      th2.textContent = 'Score';
      th2.style.textAlign = 'center';
      headerRow.appendChild(th1);
      headerRow.appendChild(th2);
      thead.appendChild(headerRow);
      picksTable.appendChild(thead);

      const tbody = document.createElement('tbody');

      golferNames.forEach((golferName) => {
        const score = golferScores[golferName] || 'N/A'; // If the golfer's score is not found, display 'N/A'

        const tableRow = document.createElement('tr');
        const td1 = document.createElement('td');
        // td1.style.textAlign = 'center';
        td1.textContent = golferName;
        const td2 = document.createElement('td');
        td2.textContent = score;
        td2.style.textAlign = 'center';
        tableRow.appendChild(td1);
        tableRow.appendChild(td2);
        tbody.appendChild(tableRow);
      });

      picksTable.appendChild(tbody);

      $('#picksModal').modal('show');
    }


    document.getElementById('close-picks').addEventListener('click', () => {
      document.getElementById('player-picks').style.display = 'none';
    });

    fetchGoogleSheetsData();
  </script>
  <div class="modal fade" id="picksModal" tabindex="-1" role="dialog" aria-labelledby="picksModalLabel"
    aria-hidden="true">
    <div class="modal-dialog mx-auto" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="picksModalLabel">Player Picks</h5>
          <!-- uncomment line below to bring back X button -->
          <!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> -->
        </div>
        <div class="modal-body">
          <div class="table-responsive">
            <table id="picks-table" class="table table-striped table-bordered"></table>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>


</body>

</html>